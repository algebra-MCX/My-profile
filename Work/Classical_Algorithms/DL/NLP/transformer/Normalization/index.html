
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://algebra-mcx.github.io/Academic-Profile/Work/Classical_Algorithms/DL/NLP/transformer/Normalization/">
      
      
        <link rel="prev" href="../Mask/">
      
      
        <link rel="next" href="../Enco_Deco/">
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Normalization - Chenxi Ma</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/card2.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#normalization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Chenxi Ma" class="md-header__button md-logo" aria-label="Chenxi Ma" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Chenxi Ma
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Normalization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/algebra-MCX/Academic-Profile" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Academic-Profile
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../../paper/method/blogs/" class="md-tabs__link">
          
  
  
    
  
  AI

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../Others/git/git%E7%90%86%E8%A7%A3/" class="md-tabs__link">
          
  
  
    
  
  其他有用技术

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../project/AI%20infra/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%E6%A1%86%E6%9E%B6/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/" class="md-tabs__link">
          
  
  
    
  
  Projects

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../publications/" class="md-tabs__link">
          
  
  
    
  
  Publications

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../cv.md" class="md-tabs__link">
          
  
  
    
  
  CV

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../contact/" class="md-tabs__link">
        
  
  
    
  
  Contact me

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../tags/" class="md-tabs__link">
          
  
  
    
  
  Tags

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Chenxi Ma" class="md-nav__button md-logo" aria-label="Chenxi Ma" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Chenxi Ma
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/algebra-MCX/Academic-Profile" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Academic-Profile
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    AI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Blogs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Blogs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1_1" id="__nav_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    论文写作
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            论文写作
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/method/blogs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何找idea
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/method/blogs_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    论文写作
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1_2" id="__nav_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Classical Algorithms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            Classical Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1_2_1" id="__nav_1_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            DL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1_2_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1_2_1_1" id="__nav_1_1_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    NLP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_1_2_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            NLP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1_2_1_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1_2_1_1_1" id="__nav_1_1_2_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    transformer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_1_2_1_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1_2_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tokenization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tokenization分词器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tokenization补充
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../word_embedding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Word Embedding词嵌入
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Pos_embed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Positional Embedding位置编码
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attention注意力
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attention2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attention(2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FFN_activation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FFN和激活函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mask掩码
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Normalization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Normalization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bn" class="md-nav__link">
    <span class="md-ellipsis">
      BN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bn_1" class="md-nav__link">
    <span class="md-ellipsis">
      为什么进行BN?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_2" class="md-nav__link">
    <span class="md-ellipsis">
      BN的计算过程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_3" class="md-nav__link">
    <span class="md-ellipsis">
      BN的作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_4" class="md-nav__link">
    <span class="md-ellipsis">
      BN存在的问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layer-normalizationln" class="md-nav__link">
    <span class="md-ellipsis">
      Layer Normalization(LN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layer Normalization(LN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ln" class="md-nav__link">
    <span class="md-ellipsis">
      LN计算公式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LN计算公式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      统计量计算维度：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      数学公式：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      特点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformerlayernorm" class="md-nav__link">
    <span class="md-ellipsis">
      Transformer中的LayerNorm解释
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-normalizationin" class="md-nav__link">
    <span class="md-ellipsis">
      Instance Normalization(IN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instance Normalization(IN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in" class="md-nav__link">
    <span class="md-ellipsis">
      IN计算公式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in_1" class="md-nav__link">
    <span class="md-ellipsis">
      IN的特点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#group-normalizationgn" class="md-nav__link">
    <span class="md-ellipsis">
      Group Normalization(GN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Group Normalization(GN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gn" class="md-nav__link">
    <span class="md-ellipsis">
      GN的计算方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bnlningn" class="md-nav__link">
    <span class="md-ellipsis">
      BN、LN、IN、GN区别
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rms-norm" class="md-nav__link">
    <span class="md-ellipsis">
      RMS Norm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RMS Norm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layernorm" class="md-nav__link">
    <span class="md-ellipsis">
      与LayerNorm的区别
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      优点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      缺点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prms-norm" class="md-nav__link">
    <span class="md-ellipsis">
      pRMS Norm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      优势
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      应用场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-lnpre-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Post-LN与Pre-LN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-LN与Pre-LN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Post-LN 结构：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-LN 结构：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-norm" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deep Norm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deep-norm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm的提出
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-norm_2" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm的原理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Enco_Deco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoder and Decoder
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_1_1_2_2" id="__nav_1_1_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            RL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../RL/PPO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPO
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_1_3" id="__nav_1_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_3_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1_3_1" id="__nav_1_1_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LLM Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            LLM Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1_3_1_1" id="__nav_1_1_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Encoder-only
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_1_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Encoder-only
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LLM/LLM_Architecture/Encoder_only/%E9%A2%84%E8%AE%AD%E7%BB%83%E4%BB%BB%E5%8A%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoder-only预训练任务
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LLM/LLM_Architecture/Encoder_only/BERT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BERT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LLM/LLM_Architecture/Encoder_only/Sentence_BERT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sentence-BERT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_3_2" >
        
          
          <label class="md-nav__link" for="__nav_1_1_3_2" id="__nav_1_1_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pre-training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            Pre-training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LLM/Pre-training/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E9%A2%84%E8%AE%AD%E7%BB%83%E5%85%A8%E8%A7%A3%E6%9E%90%EF%BC%9A%E5%AE%9A%E4%B9%89%E3%80%81%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E3%80%81%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%A4%9A%E9%98%B6%E6%AE%B5%E8%AE%AD%E7%BB%83%E9%80%BB%E8%BE%91/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    大模型预训练概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LLM/Pre-training/%E9%A2%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    预训练数据
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_1_4" id="__nav_1_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    paper解读
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            paper解读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_4_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1_4_1" id="__nav_1_1_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    tech_report
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            tech_report
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1_4_1_1" id="__nav_1_1_4_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deepseek
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_1_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            Deepseek
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/read/tech_report/Deepseek/DeepSeek_v3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deepseek v3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/read/tech_report/Deepseek/Deepseek_r1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deepseek r1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_1_4_2" >
        
          
          <label class="md-nav__link" for="__nav_1_1_4_2" id="__nav_1_1_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_1_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_4_2">
            <span class="md-nav__icon md-icon"></span>
            RM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/read/RM/TTRL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TTRL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../paper/read/RM/LCPO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LCPO
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    其他有用技术
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            其他有用技术
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    git和github
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            git和github
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Others/git/git%E7%90%86%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    git理解
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AI infra
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            AI infra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大模型推理框架
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            大模型推理框架
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../project/AI%20infra/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%E6%A1%86%E6%9E%B6/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    项目结构
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Publications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conferences
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CV
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CV
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cv.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人简历
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact me
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人标签
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bn" class="md-nav__link">
    <span class="md-ellipsis">
      BN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bn_1" class="md-nav__link">
    <span class="md-ellipsis">
      为什么进行BN?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_2" class="md-nav__link">
    <span class="md-ellipsis">
      BN的计算过程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_3" class="md-nav__link">
    <span class="md-ellipsis">
      BN的作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bn_4" class="md-nav__link">
    <span class="md-ellipsis">
      BN存在的问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layer-normalizationln" class="md-nav__link">
    <span class="md-ellipsis">
      Layer Normalization(LN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layer Normalization(LN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ln" class="md-nav__link">
    <span class="md-ellipsis">
      LN计算公式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LN计算公式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      统计量计算维度：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      数学公式：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      特点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformerlayernorm" class="md-nav__link">
    <span class="md-ellipsis">
      Transformer中的LayerNorm解释
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-normalizationin" class="md-nav__link">
    <span class="md-ellipsis">
      Instance Normalization(IN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instance Normalization(IN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in" class="md-nav__link">
    <span class="md-ellipsis">
      IN计算公式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in_1" class="md-nav__link">
    <span class="md-ellipsis">
      IN的特点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#group-normalizationgn" class="md-nav__link">
    <span class="md-ellipsis">
      Group Normalization(GN)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Group Normalization(GN)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gn" class="md-nav__link">
    <span class="md-ellipsis">
      GN的计算方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bnlningn" class="md-nav__link">
    <span class="md-ellipsis">
      BN、LN、IN、GN区别
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rms-norm" class="md-nav__link">
    <span class="md-ellipsis">
      RMS Norm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RMS Norm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layernorm" class="md-nav__link">
    <span class="md-ellipsis">
      与LayerNorm的区别
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      优点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      缺点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prms-norm" class="md-nav__link">
    <span class="md-ellipsis">
      pRMS Norm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      优势
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      应用场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-lnpre-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Post-LN与Pre-LN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-LN与Pre-LN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Post-LN 结构：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-ln" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-LN 结构：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-norm" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deep Norm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deep-norm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm的提出
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-norm_2" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Norm的原理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/algebra-MCX/Academic-Profile/edit/main/docs/Work/Classical_Algorithms/DL/NLP/transformer/Normalization.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/algebra-MCX/Academic-Profile/raw/main/docs/Work/Classical_Algorithms/DL/NLP/transformer/Normalization.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<div><h1 id="normalization">标准化Normalization<a class="headerlink" href="#normalization" title="Permanent link">¶</a></h1>
<p><strong>Normalization作用是通过标准化隐藏层的输出，稳定训练过程，缓解梯度消失或爆炸问题，同时加速收敛并提高模型泛化能力</strong></p>
<p><strong>这里的“Add”就是残差操作，缓解深层网络梯度消失问题</strong></p>
<p><img alt="n1" src="../../../../../images/algorithm_img/n1.png"></p>
<p>Normalization（归一化）：目的是通过对激活值或特征张量进行规范化处理，使得<strong>缓解梯度消失、加速模型收敛、增强模型泛化能力</strong>.</p>
<p>又有其它多种归一化技术，如Batch Normalization(BN)、Layer Normalization(LN)、Instance Normalization(IN)、Group Normalization(GN)、RMS Norm以及
超深层模型有效的Deep Norm等。</p>
<h2 id="bn">BN<a class="headerlink" href="#bn" title="Permanent link">¶</a></h2>
<h3 id="bn_1">为什么进行BN?<a class="headerlink" href="#bn_1" title="Permanent link">¶</a></h3>
<ul>
<li>深度神经网络训练过程中，采用mini-batch进行梯度下降时，每个batch数据分布不同，使得网络各层的输入分布在训练过程中不断发生漂移（ICS），使得模型训练变得困难，收敛速度变慢。</li>
</ul>
<p>ICS是指前面batch训练时会影响到后续batch的训练，让模型在这条道路一直训练，起了形象的名字——漂移。</p>
<ul>
<li>BN核心思想是在<strong>激活函数前，对每个通道在batch维度上计算均值与方差，并将激活值约束到均值为0、方差为1的分布</strong>
（再加上可学习的缩放与偏置系数），可减小ICS问题</li>
</ul>
<h3 id="bn_2">BN的计算过程<a class="headerlink" href="#bn_2" title="Permanent link">¶</a></h3>
<p>如果某层输出维度为[N,C,H,W]，其中N表示batch_size,C为通道数，H和W分别为表示特征图的高和宽。</p>
<p><strong>沿着通道方向</strong>计算每个batch的均值和方差，即对<strong>同一通道</strong>内的所有样本像素进行统计：</p>
<p>1.<strong>计算均值<span class="arithmatex">\(\mu_c\)</span></strong>：<span class="arithmatex">\(\mu_c = \frac{1}{N\times H\times W}\sum_{n=1}^N \sum_{h=1}^H\sum_{w=1}^W x_{n,c,w,h}\)</span></p>
<p>2.<strong>计算方差<span class="arithmatex">\(\sigma_c^2\)</span></strong>:<span class="arithmatex">\(\sigma_c^2=\frac{1}{N\times H\times W\times}\sum_{n=1}^N \sum_{h=1}^H \sum_{w=1}^W (x_{n,c,h,w}-\mu_c)^2\)</span></p>
<p>3.<strong>归一化<span class="arithmatex">\(\hat{x}_{n,c,h,w}\)</span></strong>: <span class="arithmatex">\(\hat{x}_{n,c,h,w}=\frac{x_{n,c,h,w}-\mu_c}{\sqrt{\sigma^2+\epsilon}}\)</span></p>
<p><span class="arithmatex">\(\epsilon\)</span> 是一个非常小的正数，它的作用是防止分母为零或接近零的情况，从而避免计算时出现数值不稳定或错误。</p>
<p>4.<strong>缩放和平移</strong>：<span class="arithmatex">\(y_{h,c,w,h}=\gamma_c \hat{x}_{n,c,w,h}+\beta_c\)</span>,其中<span class="arithmatex">\(\gamma_c和\beta_c\)</span>为可学习参数，初始时<span class="arithmatex">\(\gamma_c=1,\beta_c=0\)</span></p>
<h3 id="bn_3">BN的作用<a class="headerlink" href="#bn_3" title="Permanent link">¶</a></h3>
<ul>
<li>减少ICS,避免梯度消失、爆炸</li>
<li>允许使用较大的学习率</li>
<li>降低对权重初始化的敏感度</li>
<li>对隐藏层输出有轻微的正则化效果（类似在隐藏层加入噪声）</li>
</ul>
<h3 id="bn_4">BN存在的问题<a class="headerlink" href="#bn_4" title="Permanent link">¶</a></h3>
<ul>
<li>当<strong>batch_size太小</strong>：统计的均值、方差估计不准确，不足以代表整体数据分布</li>
<li>当<strong>batch_size太大</strong>：消耗显存且训练慢</li>
<li>不适用于对序列长度较不固定或batch_size=1的场景，BN效果不佳</li>
</ul>
<h2 id="layer-normalizationln">Layer Normalization(LN)<a class="headerlink" href="#layer-normalizationln" title="Permanent link">¶</a></h2>
<p>在很多任务里，batch_size很小，甚至为1；在RNN里，每一步输入大小各异，
BN难以奏效。LN则解决这一问题，<strong>不依赖batch维度</strong>，在单个样本内对特征进行归一化。</p>
<h3 id="ln">LN计算公式<a class="headerlink" href="#ln" title="Permanent link">¶</a></h3>
<h4 id="_1">统计量计算维度：<a class="headerlink" href="#_1" title="Permanent link">¶</a></h4>
<ul>
<li>对于每个样本 <span class="arithmatex">\(n\)</span>，在其 <strong>所有通道 + 所有空间位置</strong> 上计算均值和方差。</li>
<li>即：每个样本自己内部做归一化。</li>
</ul>
<h4 id="_2">数学公式：<a class="headerlink" href="#_2" title="Permanent link">¶</a></h4>
<p>对于第 <span class="arithmatex">\(n\)</span> 个样本：</p>
<div class="arithmatex">\[
\mu_n = \frac{1}{C \cdot H \cdot W} \sum_{c,h,w} x_{n,c,h,w}
\]</div>
<div class="arithmatex">\[
\sigma_n^2 = \frac{1}{C \cdot H \cdot W} \sum_{c,h,w} (x_{n,c,h,w} - \mu_n)^2
\]</div>
<p>然后进行归一化：</p>
<div class="arithmatex">\[
\hat{x}_{n,c,h,w} = \frac{x_{n,c,h,w} - \mu_n}{\sqrt{\sigma_n^2 + \epsilon}}
\]</div>
<p>最后缩放和平移（对每个样本可以独立设置参数，也可以共享）：</p>
<div class="arithmatex">\[
y_{n,c,h,w} = \gamma \hat{x}_{n,c,h,w} + \beta
\]</div>
<p>（注意：这里 <span class="arithmatex">\(\gamma, \beta\)</span> 可以是每个通道一个，也可以是整个层共享）</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">normalized_shape</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>normalized_shape 指出在特征张量的哪些维度上做LN;</li>
<li>eps 为防止分母的方差估计趋近于0</li>
<li>elementwise_affine 指是否使用可学习的<span class="arithmatex">\(\gamma和\beta\)</span></li>
</ul>
<h3 id="_3">特点<a class="headerlink" href="#_3" title="Permanent link">¶</a></h3>
<ul>
<li><strong>不依赖batch</strong>: 适用与batch_size很小的情况，以及在序列建模（RNN、Transformer）的场景</li>
<li><strong>对序列建模效果明显</strong>：由于不依赖batch_size大小和时间序列长度，在循环网络中能稳定激活分布，加快收敛。</li>
<li><strong>在CNN上效果比BN差</strong>： LN统计范围相当于每个通道都被参与计算，会损失某些图像特征的局部性。</li>
</ul>
<h3 id="_4">总结<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li><strong>BN（BatchNorm）：对一个 batch 内的每个通道（channel）单独计算均值和方差。</strong></li>
<li><strong>LN（LayerNorm）：对单个样本的所有通道、空间位置一起计算均值和方差。</strong></li>
</ul>
</blockquote>
<p>BN vs LN 的关键对比</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>BatchNorm (BN)</th>
<th>LayerNorm (LN)</th>
</tr>
</thead>
<tbody>
<tr>
<td>统计维度</td>
<td>同一通道下，跨 batch 和空间</td>
<td>同一批次下，跨通道和空间</td>
</tr>
<tr>
<td>是否依赖 batch 大小</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>是否适合 RNN / Transformer</td>
<td>否</td>
<td>是 ✅</td>
</tr>
<tr>
<td>对 batch size 敏感</td>
<td>是（小 batch 影响效果）</td>
<td>否</td>
</tr>
<tr>
<td>是否保留样本差异性</td>
<td>否（batch 内共享统计）</td>
<td>是 ✅</td>
</tr>
<tr>
<td>应用场景</td>
<td>CNN 图像任务</td>
<td>NLP、Transformer、小 batch 场景</td>
</tr>
</tbody>
</table>
<p>举个例子说明差异</p>
<p>假设你有一个 batch 中有 2 张图片，每张图片有 3 个通道（RGB），尺寸是 <span class="arithmatex">\(64 \times 64\)</span>：</p>
<ul>
<li><strong>BN</strong>：对每个通道（如 R 通道）把这 2 张图的所有像素（共 <span class="arithmatex">\(2 \times 64 \times 64\)</span>）拿来算均值和方差。</li>
<li><strong>LN</strong>：对每一张图，把它所有的像素（共 <span class="arithmatex">\(3 \times 64 \times 64\)</span>）拿来算均值和方差。</li>
</ul>
<p>实际应用中的选择建议</p>
<table>
<thead>
<tr>
<th>模型类型</th>
<th>推荐使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>CNN 图像分类</td>
<td>BatchNorm ✅</td>
</tr>
<tr>
<td>RNN / LSTM / GRU</td>
<td>LayerNorm ✅</td>
</tr>
<tr>
<td>Transformer</td>
<td>LayerNorm ✅</td>
</tr>
<tr>
<td>小 batch size</td>
<td>LayerNorm 更稳定</td>
</tr>
<tr>
<td>分布变化大或 batch 不稳定</td>
<td>LayerNorm 更鲁棒</td>
</tr>
</tbody>
</table>
<p>总结</p>
<table>
<thead>
<tr>
<th>层面</th>
<th>BatchNorm</th>
<th>LayerNorm</th>
</tr>
</thead>
<tbody>
<tr>
<td>统计对象</td>
<td>每个通道（C）</td>
<td>每个样本（N）</td>
</tr>
<tr>
<td>统计范围</td>
<td>batch + 空间</td>
<td>通道 + 空间</td>
</tr>
<tr>
<td>是否依赖 batch</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>适用网络</td>
<td>CNN</td>
<td>RNN、Transformer</td>
</tr>
<tr>
<td>数学表达</td>
<td>均值 <span class="arithmatex">\(\mu_c\)</span>、方差 <span class="arithmatex">\(\sigma_c^2\)</span></td>
<td>均值 <span class="arithmatex">\(\mu_n\)</span>、方差 <span class="arithmatex">\(\sigma_n^2\)</span></td>
</tr>
</tbody>
</table>
<h2 id="transformerlayernorm">Transformer中的LayerNorm解释<a class="headerlink" href="#transformerlayernorm" title="Permanent link">¶</a></h2>
<p><img alt="f" src="../../../../../images/algorithm_img/n2.png"></p>
<p>对这张图可能会做出这样的转化：<span class="arithmatex">\(N \sim Batch_size, C \sim seq_len, H、W\sim hidden_sim\)</span></p>
<p>不过这样转化对BatchNorm是可以的，但对于LayerNorm就不对了。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">Examples</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1"># NLP Example</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">batch</span><span class="p">,</span> <span class="n">sentence_length</span><span class="p">,</span> <span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">embedding</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">sentence_length</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">layer_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">embedding_dim</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Activate module</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">layer_norm</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="c1"># Image Example</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Normalize over the last three dimensions (i.e. the channel and spatial dimensions)</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">layer_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">([</span><span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">])</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">output</span> <span class="o">=</span> <span class="n">layer_norm</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>可以看到对于NLP model(Bert之后的)LayerNorm有着不同的用法，可以用下面这张图描述，
LayerNorm是对每一个token的hidden_dim做归一化：</p>
<p><img alt="f" src="../../../../../images/algorithm_img/n3.png"></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span> <span class="n">normalized_shape</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>LN的归一化需要两个trainable参数，以及分母上的eps</p>
<ul>
<li>手撕LayerNorm (deepseek面试题)
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">LayerNorm</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featurea</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zero</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>        <span class="n">mean</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>        <span class="n">std</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">unbiased</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">std</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="n">fearures</span> <span class="o">=</span> <span class="mi">768</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="n">layer_norm</span> <span class="o">=</span> <span class="n">LayerNorm</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="n">normalized_x</span> <span class="o">=</span> <span class="n">layer_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">normalized_x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h2 id="instance-normalizationin">Instance Normalization(IN)<a class="headerlink" href="#instance-normalizationin" title="Permanent link">¶</a></h2>
<p>IN最初用于图像风格迁移任务。原因在于：在风格化生成网络中，每张图像风格往往只受单张图像本身的特征分布影响。</p>
<p>BN这种“跨样本”的归一化无法保留单张图像的风格差异，因此需要在<strong>每张图像的特征图上分别做归一化</strong>，即在<span class="arithmatex">\(H\times W\)</span>维度上进行操作，而保留batch和通道维度。</p>
<h3 id="in">IN计算公式<a class="headerlink" href="#in" title="Permanent link">¶</a></h3>
<p>对输入<span class="arithmatex">\(x\in R^{N\times C\times W\times H}\)</span> ,IN在每个样本n、每个通道c的特征图上计算均值和方差：</p>
<div class="arithmatex">\[\mu_{n,c}=\frac{1}{HW}\sum_{h=1}^H\sum_{w=1}^W x_{n,c,h,w}, \sigma_{n,c}^2=\frac{1}{HW}\sum_{h=1}^H\sum_{w=1}^W(x_{n,c,h,w}-\mu_{n,c})^2\]</div>
<div class="arithmatex">\[y_{n,c,h,w}=\frac{x_{n,c,w,h}-\mu_{n,c}}{\sigma_{n,c}^2+\epsilon}\]</div>
<p>可以加上可学习的<span class="arithmatex">\(\gamma, \beta\)</span></p>
<h3 id="in_1">IN的特点<a class="headerlink" href="#in_1" title="Permanent link">¶</a></h3>
<ul>
<li><strong>对每个样本、每个通道分别进行归一化</strong>：不考虑batch内其它样本，与BN不同</li>
<li><strong>风格化迁移</strong>：可保证不同样本之间的风格差异</li>
<li><strong>特征图上归一化</strong>： 去掉了<span class="arithmatex">\(H\times W\)</span>中的统计差异，但保留了跨样本、跨通道的变化</li>
</ul>
<hr>
<p><strong>IN和LN有什么区别</strong></p>
<p>可训练参数上是有区别的，layer_norm为hidden_dim上的每一个数字维护<span class="arithmatex">\(\gamma和\beta\)</span>,
instance_norm为seq_len上的每一个数字维护<span class="arithmatex">\(\gamma和\beta\)</span></p>
<h2 id="group-normalizationgn">Group Normalization(GN)<a class="headerlink" href="#group-normalizationgn" title="Permanent link">¶</a></h2>
<p>GN是解决BN对batch size依赖较大的问题：当batch size非常小（如图像分割、超大模型训练时），BN估计均值和方差出现偏差，效果变差。</p>
<p>GN提出将通道分组后，各分组内部做LN类似的归一化</p>
<h3 id="gn">GN的计算方式<a class="headerlink" href="#gn" title="Permanent link">¶</a></h3>
<p>假设有C个通道，将其分成G组（每组有C/G个通道），在单样本特征图中，对同一组中的所有通道和其对应的空间位置<span class="arithmatex">\(H\times W\)</span>做均值和方差计算：</p>
<div class="arithmatex">\[\mu_{n,g}=\frac{1}{(C/G)HW}\sum_{c=g\frac{C}{G}}^{(g+1)\frac{C}{G}-1}\sum_{h=1}^H\sum_{w=1}^W x_{n,cmh,w}\]</div>
<div class="arithmatex">\[\sigma_{n,g}=\sqrt{\frac{1}{(\frac{C/G}HW)}\sum_{c=g\frac{C}{G}}^{(g+1)\frac{C}{G}-1}\sum_{h=1}^H\sum_{w=1}^W(x_{n,c,h,w}-\mu_{n,g})^2+\epsilon}\]</div>
<p>再进行标准化与可学习的缩放和平移。GN是BN与LN的一种折中，既比LN更关注通道结构，有不依赖batch_size，适合小batch_size场景。</p>
<hr>
<h3 id="bnlningn">BN、LN、IN、GN区别<a class="headerlink" href="#bnlningn" title="Permanent link">¶</a></h3>
<p>假设输入特征的形状为 [N, C, H, W] ，它们的区别：</p>
<ol>
<li>
<p><strong>BN</strong>：在batch维度上做归一化（对N × H × W做均值和方差），保留通道维度C。适用于CNN，中等或大batch size；不适合极小batch或RNN场景。</p>
</li>
<li>
<p><strong>LN</strong>：在单个样本中对C×H×W的所有元素做归一化。适合RNN、Transformer等序列场景，对batch size不敏感；在CNN上效果不如BN。 </p>
</li>
<li>
<p><strong>IN</strong>：在单张图片、单个通道上，对H×W进行归一化。常用于风格迁移，保留跨图片、跨通道的风格差异。 </p>
</li>
<li>
<p><strong>GN</strong>：将通道C分成G组，在同一组内进行LN式归一化；既不依赖batch size，又兼顾通道间统计特性，适合小batch size场景。 </p>
</li>
</ol>
<hr>
<h2 id="rms-norm">RMS Norm<a class="headerlink" href="#rms-norm" title="Permanent link">¶</a></h2>
<h3 id="_5">原理<a class="headerlink" href="#_5" title="Permanent link">¶</a></h3>
<ul>
<li><strong>计算均方根（RMS）</strong>：给定输入向量 <span class="arithmatex">\(\mathbf{x} \in \mathbb{R}^d\)</span> （<span class="arithmatex">\(d\)</span> 为特征维度） ，RMS Norm通过计算输入特征的均方根进行归一化，公式为 <span class="arithmatex">\(\text{RMS}(\mathbf{x}) = \sqrt{\frac{1}{d} \sum_{i = 1}^{d} x_{i}^{2}}\)</span>  ，不进行均值计算与减法操作。</li>
<li><strong>归一化与缩放</strong>：归一化输入向量 <span class="arithmatex">\(\hat{\mathbf{x}} = \frac{\mathbf{x}}{\text{RMS}(\mathbf{x})}\)</span> ，并通过可学习的缩放系数 <span class="arithmatex">\(g_{i}\)</span> （或表示为 <span class="arithmatex">\(\gamma\)</span> ）对其缩放 ，得到最终归一化输出 <span class="arithmatex">\(\text{RMSNorm}(\mathbf{x}) = \gamma \odot \hat{\mathbf{x}}\)</span>  （<span class="arithmatex">\(\odot\)</span> 表示元素级乘法） 。</li>
</ul>
<h3 id="layernorm">与LayerNorm的区别<a class="headerlink" href="#layernorm" title="Permanent link">¶</a></h3>
<p>LayerNorm计算输入特征的均值 <span class="arithmatex">\(\mu\)</span> 和标准差 <span class="arithmatex">\(\sigma\)</span> ，公式为 <span class="arithmatex">\(\text{LN}(h_i) = \frac{h_i - \mu_{h_i}}{\sqrt{\sigma_{h_i}^2 + \epsilon}} * \gamma + \beta\)</span> ，需进行均值减法和标准差除法操作，且有可学习的缩放参数 <span class="arithmatex">\(\gamma\)</span> 与偏移参数 <span class="arithmatex">\(\beta\)</span> ；RMS Norm不计算均值，仅依赖均方根归一化，没有额外可学习的偏移参数，简化了计算流程。</p>
<h3 id="_6">优点<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3>
<ul>
<li><strong>计算高效</strong>：省去均值计算步骤，减少约10% - 30%计算开销，尤其在大模型或处理长序列数据时，能显著提升计算效率。</li>
<li><strong>数值稳定</strong>：避免了均值接近零时可能出现的数值不稳定问题，在某些应用中，LayerNorm因均值计算不稳定导致训练波动，RMS Norm去除该步骤使训练更平滑。 </li>
<li><strong>适用性广</strong>：作为简单高效的归一化方法，无需依赖批量大小或输入分布，能处理变长输入序列，在Transformer和自注意力机制等序列模型中表现良好，被广泛应用于现代架构（如LLaMA、GPT - Neo等） 。</li>
<li><strong>训练加速</strong>：在部分任务上，使用RMS Norm的模型收敛速度更快，训练效率更高，处理大型数据集时优势明显。</li>
</ul>
<h3 id="_7">缺点<a class="headerlink" href="#_7" title="Permanent link">¶</a></h3>
<ul>
<li><strong>无均值归一化限制</strong>：在某些对输入数据均值敏感的任务中（如图像数据处理） ，表现可能不如LayerNorm，因为去除均值计算可能影响模型对关键特征的捕捉。</li>
<li><strong>缺乏批量统计依赖</strong>：虽适合处理变长序列，但在有足够大批量数据的任务中，BatchNorm利用批量统计量可能取得更好效果。 </li>
</ul>
<h3 id="prms-norm">pRMS Norm<a class="headerlink" href="#prms-norm" title="Permanent link">¶</a></h3>
<p>在深度学习中，当处理超大向量或者特征数极多的情况时，RMS Norm（Root Mean Square Layer Normalization）需要对整个向量计算均方根，计算量会变得很大。为了在不显著影响模型性能的前提下减小计算量，pRMS Norm（Partial Root Mean Square Layer Normalization）应运而生。它通过只使用部分元素来计算RMS值，从而降低计算成本，尤其适用于大规模模型的训练与推理。</p>
<h3 id="_8">原理<a class="headerlink" href="#_8" title="Permanent link">¶</a></h3>
<p>pRMS Norm的核心在于只选取向量中前 <span class="arithmatex">\(p\%\)</span> 的元素来计算RMS值。假设向量 <span class="arithmatex">\(\mathbf{a} = [a_1, a_2, \cdots, a_n]\)</span> ，其中 <span class="arithmatex">\(n\)</span> 是向量的长度。首先确定用于计算的元素个数 <span class="arithmatex">\(k\)</span> ，<span class="arithmatex">\(k = n\times p\)</span> （这里 <span class="arithmatex">\(p\)</span> 是一个比例值，比如 <span class="arithmatex">\(p = 0.1\)</span> 表示选取前10%的元素 ）。</p>
<p>然后按照以下公式计算均方根值：
<span class="arithmatex">\(\overline{RMS}(\mathbf{a})=\sqrt{\frac{1}{k}\sum_{i = 1}^{k}a_{i}^{2}}\)</span></p>
<p>也就是说，它不是对整个向量的所有元素进行均方根计算，而是仅基于选定的部分元素来计算。这样在大规模向量计算时，就可以大幅减少计算量。</p>
<h3 id="_9">优势<a class="headerlink" href="#_9" title="Permanent link">¶</a></h3>
<ul>
<li><strong>计算量降低</strong>：在超大向量或者特征维度极高的场景下，通过只使用部分元素计算RMS，能显著减少计算量。例如在一些大语言模型中，处理长文本序列时，特征向量维度很大，pRMS Norm可以有效降低计算成本，加速训练和推理过程。</li>
<li><strong>性能保留</strong>：在实际测试中发现，pRMS Norm在减少计算量的同时，还能较好地保留模型的收敛性能。这意味着它不会因为减少了计算量而使模型的训练效果大打折扣，依然能够让模型在合理的时间内达到较好的训练结果。</li>
</ul>
<h3 id="_10">应用场景<a class="headerlink" href="#_10" title="Permanent link">¶</a></h3>
<p>主要适用于大规模深度学习模型，尤其是那些处理长序列数据的模型，比如大语言模型（LLMs）。在这些模型中，输入序列可能很长，对应的特征向量维度很高，传统的RMS Norm计算开销大，而pRMS Norm可以平衡计算效率和模型性能，使得模型在有限的计算资源下也能高效运行。同时，在一些处理高维图像特征等场景中，如果存在类似的计算量过大问题，也可以考虑应用pRMS Norm来优化计算过程。  </p>
<hr>
<h2 id="post-lnpre-ln">Post-LN与Pre-LN<a class="headerlink" href="#post-lnpre-ln" title="Permanent link">¶</a></h2>
<p><img alt="f" src="../../../../../images/algorithm_img/n5.png"></p>
<p>Transformer中，残差连接与LN的先后顺序分为：</p>
<p>1.<strong>Post-LN</strong>： 在自注意力/FFN + 残差连接之后再做LN</p>
<p>2.<strong>Pre-LN</strong>:在自注意力/FFN之前先做LN ，再加上残差连接</p>
<h4 id="post-ln">Post-LN 结构：<a class="headerlink" href="#post-ln" title="Permanent link">¶</a></h4>
<ul>
<li>将LN放在残差之后，有更强的正则化效果；</li>
<li>但在深层网络中，有时出现训练不稳定（梯度不易传递或爆炸）。</li>
</ul>
<p><strong>更强正则化效果</strong>：将 LN 放在残差之后，对残差块输出的所有参数进行归一化，使得参数分布更加规整，相当于对模型施加了更强的约束，限制了参数的取值范围，增强了正则化效果，有助于防止模型过拟合 。</p>
<p><strong>训练不稳定</strong>：在深层网络中，梯度要经过较多的计算层回传。由于 Post - LN 对所有参数归一化，当网络层数加深，每层的输出经过归一化后，可能会使梯度在反向传播时出现异常变化，比如梯度值变得过大或过小，导致梯度爆炸或消失，使得训练不稳定，难以有效更新参数 。</p>
<h4 id="pre-ln">Pre-LN 结构：<a class="headerlink" href="#pre-ln" title="Permanent link">¶</a></h4>
<ul>
<li>在残差前先做LN，以保证梯度能够更顺畅地传递；</li>
<li>更易训练且更稳定，但有时模型的最终性能不如Post-LN高。 </li>
</ul>
<p><strong>梯度传递顺畅</strong>：在残差前先做 LN，对输入到残差块的信号进行归一化，使得输入数据分布更稳定，能让梯度在反向传播过程中更顺畅地通过各层，避免因数据分布变化过大导致梯度异常，所以训练过程更加稳定 。</p>
<p><strong>最终性能受限</strong>：Pre - LN 将部分参数进行归一化，部分参数直接加在后面（没有正则化） ，从某种程度上降低了网络的等效深度，近似于使网络变 “宽”，但深度神经网络中深度往往对性能很关键。这种结构无形之中降低深度，可能影响模型对复杂特征的学习和表示能力，导致有时最终性能不如 Post - LN 高 。</p>
<p><img alt="f" src="../../../../../images/algorithm_img/n4.png"></p>
<p>Deep Norm 则实在Post-LN的基础上加上缩放系数<span class="arithmatex">\(\alpha,\beta\)</span>,在深层网络中既能维持训练稳定性，也能保持Post-LN的优势。</p>
<hr>
<h2 id="deep-norm">Deep Norm<a class="headerlink" href="#deep-norm" title="Permanent link">¶</a></h2>
<h3 id="deep-norm_1">Deep Norm的提出<a class="headerlink" href="#deep-norm_1" title="Permanent link">¶</a></h3>
<p>Deep Norm主要用于超深层Transformer的稳定训练。它是在原有Post-LN（LayerNorm放在残差连接后）结构的基础上做了两点改进：</p>
<ol>
<li>
<p>在残差连接前乘以一个系数 <span class="arithmatex">\(\alpha\)</span>，以缩放输入特征；</p>
</li>
<li>
<p>在Xavier初始化时，对部分参数乘以 <span class="arithmatex">\(\beta\)</span>，以减小初始化范围。</p>
</li>
</ol>
<p>参数参考：</p>
<table>
<thead>
<tr>
<th>Architectures</th>
<th>Encoder</th>
<th></th>
<th>Decoder</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><span class="arithmatex">\(\alpha\)</span></td>
<td><span class="arithmatex">\(\beta\)</span></td>
<td><span class="arithmatex">\(\alpha\)</span></td>
<td><span class="arithmatex">\(\beta\)</span></td>
</tr>
<tr>
<td>Encoder-only (e.g., BERT)</td>
<td><span class="arithmatex">\((2N)^{\frac{1}{4}}\)</span></td>
<td><span class="arithmatex">\((8N)^{-\frac{1}{4}}\)</span></td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Decoder-only (e.g., GPT)</td>
<td>-</td>
<td>-</td>
<td><span class="arithmatex">\((2M)^{\frac{1}{4}}\)</span></td>
<td><span class="arithmatex">\((8M)^{-\frac{1}{4}}\)</span></td>
</tr>
<tr>
<td>Encoder-decoder (e.g., NMT, T5)</td>
<td><span class="arithmatex">\(0.81(N^{4}M)^{\frac{1}{10}}\)</span></td>
<td><span class="arithmatex">\(0.87(N^{4}M)^{-\frac{1}{10}}\)</span></td>
<td><span class="arithmatex">\((3M)^{\frac{1}{4}}\)</span></td>
<td><span class="arithmatex">\((12M)^{-\frac{1}{4}}\)</span></td>
</tr>
</tbody>
</table>
<h3 id="deep-norm_2">Deep Norm的原理<a class="headerlink" href="#deep-norm_2" title="Permanent link">¶</a></h3>
<p>论文提出，如果仅使用后归一化（Post-LN）时，在极深层网络中，梯度容易累积放大，导致训练不稳定。Deep Norm的做法是在每个残差连接前都用 <span class="arithmatex">\(\alpha\)</span> 把输入放大或缩小，并在初始化时用 <span class="arithmatex">\(\beta\)</span> 调整部分参数的分布。作者通过理论和实验证明：</p>
<ul>
<li>这种缩放可以让模型的“预期更新”维持在一个恒定水平，不会导致梯度爆炸或梯度消失；</li>
<li>Deep Norm在保持Post-LN良好收敛性的同时，也像Pre-LN那样使得超深层训练变得稳定。</li>
</ul>
<p>Deep Norm的实现在microsoft/torchscale中可见。对比Pre-LN的方案，Deep Norm保留了更强的正则化效果，且能将Transformer堆叠到上千层深度。 </p></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Mask/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Mask掩码">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Mask掩码
              </div>
            </div>
          </a>
        
        
          
          <a href="../Enco_Deco/" class="md-footer__link md-footer__link--next" aria-label="Next: Encoder and Decoder">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Encoder and Decoder
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["announce.dismiss", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.action.edit", "content.action.view", "content.code.annotate"], "search": "../../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {"\u003ctag\u003e": "\u003cidentifier\u003e"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://kit.fontawesome.com/2b1d8a9758.js"></script>
      
        <script src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"></script>
      
        <script src="../../../../../../javascripts/extra.js"></script>
      
        <script src="../../../../../../javascripts/bannerSlider.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js"></script>
      
        <script src="../../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://github.com/Wcowin/Wcowin.github.io/blob/main/docs/javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
      
        <script src="../../../../../../javascripts/backbound1.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.0.2/dist/add-html-label-6e56ed67.min.js"></script>
      
        <script src="https://res.zvo.cn/translate/translate.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/view.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax @3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>